# Lab1IntSys - Система извлечения координат ДТП из текста

*Лабораторная работа №1 по интеллектуальным системам*

Программа для автоматического извлечения координат места ДТП из новостного текста на русском языке.

## Описание задачи

На вход программе подается текст, описывающий ДТП в Санкт-Петербурге. Программа анализирует текст, находит упоминания географических объектов (улиц, станций метро) и их пространственных отношений (например, пересечений), и на основе этого определяет наиболее вероятные координаты происшествия.

## Используемый подход

Решение основано на методе с использованием газетира — справочника географических объектов.

1.  **Сбор данных**: Данные для газетира собираются из OpenStreetMap с помощью Overpass API. Скрипт `builder.py` автоматически загружает актуальные данные по улицам и станциям метро Санкт-Петербурга.
2.  **Анализ текста**:
    *   Текст и названия объектов в газетире нормализуются (приводятся к нижнему регистру и начальной форме слов) с помощью библиотеки `pymorphy3`.
    *   Программа ищет в тексте упоминания объектов из газетира.
    *   Особое внимание уделяется поиску пересечений: если в тексте рядом с ключевыми словами "перекресток" или "пересечение" упоминаются две улицы, вычисляются координаты их пересечения с помощью `shapely`.
3.  **Определение координат**:
    *   Собираются все найденные точки-кандидаты (пересечения, станции метро).
    *   Итоговые координаты вычисляются как среднее арифметическое всех найденных кандидатов. Если кандидаты не найдены, возвращаются координаты центра Санкт-Петербурга.

## Структура проекта

*   `main.py`: Основной скрипт для анализа текстов и извлечения координат.
*   `builder.py`: Скрипт для сборки газетира (`spb_gazetteer.json`) из OpenStreetMap.
*   `extractor.py`, `gazetteer.py`, `structures.py`: Вспомогательные модули с основной логикой.
*   `requirements.txt`: Файл с необходимыми для работы библиотеками.
*   `spb_gazetteer.json`: Газетир (генерируется с помощью `builder.py`).
*   `rta_texts.json`: Тестовые данные с текстами о ДТП и реальными координатами.
*   `test_results.json`: Файл, в который сохраняются результаты тестирования.

## Как запустить

1.  **Установите зависимости:**
    ```bash
    pip install -r requirements.txt
    ```

2.  **Соберите газетир:**
    *Запустите скрипт `builder.py`. Это может занять несколько минут, так как он загружает большой объем данных из OpenStreetMap.*
    ```bash
    python builder.py
    ```
    В результате будет создан файл `spb_gazetteer.json`.

3.  **Запустите основной скрипт анализа:**
    ```bash
    python main.py
    ```

Скрипт обработает все тексты из `rta_texts.json`, выведет в консоль таблицу с результатами и сохранит их в `test_results.json`.
